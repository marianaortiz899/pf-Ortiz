import{a as ne}from"./chunk-UTTZ3PTC.js";import{a as Fe}from"./chunk-ILUEF3S7.js";import{a as $}from"./chunk-FRWBXVHU.js";import{a as j}from"./chunk-TYCAFV25.js";import{a as V}from"./chunk-GIPJPKZG.js";import{c as ie}from"./chunk-MGAOFYJB.js";import{n as te}from"./chunk-RJSKI22Y.js";import{$ as Me,Ca as ye,G as D,H as oe,I as ae,J as me,K as le,L as y,M as x,N as F,O as se,P as de,Q as ce,R as pe,S as ue,T as fe,U as _e,V as he,W as Ce,X as Se,Y as xe,Z as ve,_ as ge,a as re,aa as Ee,ba as be,ca as Ue,da as we,ea as Ie,fa as R,ia as k,ja as Ne,ka as L,la as Te,ma as A,na as De,oa as H,u as T}from"./chunk-JAVY5PA6.js";import{Cb as a,Eb as g,Ib as P,Jb as K,Kb as Q,Na as s,Oa as v,Qa as z,Sa as J,Vb as W,Xa as h,Yb as X,Za as d,_b as Y,a as G,da as b,ga as U,gb as i,hb as r,ia as w,ib as u,ic as Z,ja as I,jb as C,jc as ee,kb as S,lc as M,mb as N,na as f,oa as _,qb as c,sb as p,u as O,z as q}from"./chunk-KXB77ZPS.js";var Ve=(()=>{let t=class t{constructor(m){this.fb=m,this.userSubmitted=new J,this.userForm=this.fb.group({firstName:this.fb.control("",[x.required,$]),lastName:this.fb.control("",[x.required,$]),email:this.fb.control("",[x.required,x.email]),password:this.fb.control("",[x.required]),role:this.fb.control("",[x.required])})}onSubmit(){this.userForm.invalid?this.userForm.markAllAsTouched():(this.userSubmitted.emit(this.userForm.value),this.userForm.reset(),this.userForm.markAsUntouched())}ngOnInit(){}};t.\u0275fac=function(n){return new(n||t)(v(fe))},t.\u0275cmp=w({type:t,selectors:[["app-user-form"]],outputs:{userSubmitted:"userSubmitted"},decls:35,vars:1,consts:[[1,"grid","formgrid",3,"formGroup","ngSubmit"],[1,"col-6"],[1,"w-full"],["formControlName","firstName","matInput","","type","text"],["formControlName","lastName","matInput","","type","text"],[1,"col-12"],["formControlName","email","matInput","","type","text"],["formControlName","password","matInput","","type","password"],["formControlName","role","matInput",""],["value","ADMIN"],["value","USER"],["value","STUDENT"],[1,"col-12","flex","justify-content-end"],["mat-raised-button","","color","accent"]],template:function(n,l){n&1&&(i(0,"form",0),c("ngSubmit",function(){return l.onSubmit()}),i(1,"div",1)(2,"mat-form-field",2)(3,"mat-label"),a(4,"Nombre"),r(),u(5,"input",3),r()(),i(6,"div",1)(7,"mat-form-field",2)(8,"mat-label"),a(9,"Apellido"),r(),u(10,"input",4),r()(),i(11,"div",5)(12,"mat-form-field",2)(13,"mat-label"),a(14,"Email"),r(),u(15,"input",6),r()(),i(16,"div",1)(17,"mat-form-field",2)(18,"mat-label"),a(19,"Contrase\xF1a"),r(),u(20,"input",7),r()(),i(21,"div",1)(22,"mat-form-field",2)(23,"mat-label"),a(24,"Rol"),r(),i(25,"mat-select",8)(26,"mat-option",9),a(27,"ADMIN"),r(),i(28,"mat-option",10),a(29,"USER"),r(),i(30,"mat-option",11),a(31,"STUDENT"),r()()()(),i(32,"div",12)(33,"button",13),a(34,"Guardar"),r()()()),n&2&&d("formGroup",l.userForm)},dependencies:[k,R,L,A,T,D,ce,y,F,se,pe,ue],styles:[".mat-mdc-text-field-wrapper.mdc-text-field{background-color:#fae0e4!important}"]});let e=t;return e})();function Oe(e,t){e&1&&(i(0,"th",15),a(1," ID "),r())}function qe(e,t){if(e&1&&(i(0,"td",16),a(1),r()),e&2){let o=t.$implicit;s(),g(" ",o.id," ")}}function ze(e,t){e&1&&(i(0,"th",15),a(1," Nombre Completo "),r())}function Je(e,t){if(e&1&&(i(0,"td",16),a(1),P(2,"fullName"),r()),e&2){let o=t.$implicit;s(),g(" ",K(2,1,o)," ")}}function Ke(e,t){e&1&&(i(0,"th",15),a(1," Email "),r())}function Qe(e,t){if(e&1&&(i(0,"td",16),a(1),r()),e&2){let o=t.$implicit;s(),g(" ",o.email," ")}}function We(e,t){e&1&&(i(0,"th",15),a(1," Rol "),r())}function Xe(e,t){if(e&1&&(i(0,"td",16),a(1),r()),e&2){let o=t.$implicit;s(),g(" ",o.role," ")}}function Ye(e,t){e&1&&(i(0,"th",15),a(1," Fecha de creaci\xF3n "),r())}function Ze(e,t){if(e&1&&(i(0,"td",16),a(1),P(2,"date"),r()),e&2){let o=t.$implicit;s(),g(" ",Q(2,1,o.fecha,"dd/MM/yyyy")," ")}}function et(e,t){e&1&&u(0,"th",17)}function tt(e,t){if(e&1){let o=N();i(0,"td",16)(1,"button",18),c("click",function(){let l=f(o).$implicit,E=p(2);return _(E.onDeleteUser(l))}),i(2,"mat-icon"),a(3,"delete"),r()(),i(4,"button",18),c("click",function(){let l=f(o).$implicit,E=p(2);return _(E.editarUsuario(l))}),i(5,"mat-icon"),a(6,"edit"),r()(),i(7,"button",19)(8,"mat-icon"),a(9,"visibility"),r()()()}if(e&2){let o=t.$implicit;s(7),d("routerLink",o.id)}}function it(e,t){e&1&&u(0,"tr",20)}function rt(e,t){e&1&&u(0,"tr",21)}function nt(e,t){if(e&1){let o=N();i(0,"div")(1,"app-user-form",2),c("userSubmitted",function(n){f(o);let l=p();return _(l.onUserSubmitted(n))}),r(),u(2,"h1"),i(3,"table",3),C(4,4),h(5,Oe,2,0,"th",5)(6,qe,2,1,"td",6),S(),C(7,7),h(8,ze,2,0,"th",5)(9,Je,3,3,"td",6),S(),C(10,8),h(11,Ke,2,0,"th",5)(12,Qe,2,1,"td",6),S(),C(13,9),h(14,We,2,0,"th",5)(15,Xe,2,1,"td",6),S(),C(16,10),h(17,Ye,2,0,"th",5)(18,Ze,3,4,"td",6),S(),C(19,11),h(20,et,1,0,"th",12)(21,tt,10,1,"td",6),S(),h(22,it,1,0,"tr",13)(23,rt,1,0,"tr",14),r()()}if(e&2){let o=p();s(3),d("dataSource",o.dataSource),s(19),d("matHeaderRowDef",o.displayedColumns),s(),d("matRowDefColumns",o.displayedColumns)}}function ot(e,t){if(e&1){let o=N();i(0,"div")(1,"mat-form-field")(2,"mat-label"),a(3,"Nombre"),r(),i(4,"input",22),c("ngModelChange",function(n){f(o);let l=p();return _(l.userEdit.firstName=n)}),r()(),i(5,"mat-form-field")(6,"mat-label"),a(7,"Apellido"),r(),i(8,"input",22),c("ngModelChange",function(n){f(o);let l=p();return _(l.userEdit.lastName=n)}),r()(),i(9,"mat-form-field")(10,"mat-label"),a(11,"Email"),r(),i(12,"input",22),c("ngModelChange",function(n){f(o);let l=p();return _(l.userEdit.email=n)}),r()(),i(13,"mat-form-field")(14,"mat-label"),a(15,"Rol"),r(),i(16,"mat-select",23),c("ngModelChange",function(n){f(o);let l=p();return _(l.userEdit.role=n)}),i(17,"mat-option",24),a(18,"ADMIN"),r(),i(19,"mat-option",25),a(20,"USER"),r(),i(21,"mat-option",25),a(22,"STUDENT"),r()()(),i(23,"button",26),c("click",function(){f(o);let n=p();return _(n.guardar())}),a(24,"guardar"),r(),i(25,"button",26),c("click",function(){f(o);let n=p();return _(n.editar=!1)}),a(26,"cancelar"),r()()}if(e&2){let o=p();s(4),d("ngModel",o.userEdit.firstName),s(4),d("ngModel",o.userEdit.lastName),s(4),d("ngModel",o.userEdit.email),s(4),d("ngModel",o.userEdit.role)}}function at(e,t){e&1&&(i(0,"div",27),u(1,"mat-spinner",28),r())}var Re=(()=>{let t=class t{constructor(m,n,l){this.cdr=m,this.UserService=n,this.loadingService=l,this.roles=[],this.displayedColumns=["id","fullName","email","role","fecha","delete"],this.dataSource=[],this.isLoading=!1,this.editar=!1,this.userEdit={id:0,firstName:"",lastName:"",email:"",password:"",role:"",token:""},this.idCounter=0,this.loadingService.setIsLoading(!0)}ngOnInit(){this.getPageData()}getPageData(){this.loadingService.setIsLoading(!0),q([this.UserService.getRoles(),this.UserService.getUsers()]).subscribe({next:m=>{this.roles=m[0],this.dataSource=m[1]},complete:()=>{this.loadingService.setIsLoading(!1)}})}onUserSubmitted(m){this.loadingService.setIsLoading(!0);let n=this.dataSource.length;this.UserService.createUser(m).subscribe({next:l=>{this.dataSource=[...l]},complete:()=>{this.loadingService.setIsLoading(!1)}})}onDeleteUser(m){this.loadingService.setIsLoading(!0),this.UserService.deleteUser(m.id).subscribe({next:n=>{this.dataSource=[...n]},complete:()=>{this.loadingService.setIsLoading(!1)}})}editarUsuario(m){this.userEdit=G({},m),this.editar=!this.editar}guardar(){let m=this.dataSource.findIndex(n=>n.id===this.userEdit.id);m!==-1&&(this.dataSource[m]=this.userEdit,this.dataSource=[...this.dataSource]),this.editar=!1}};t.\u0275fac=function(n){return new(n||t)(v(z),v(V),v(re))},t.\u0275cmp=w({type:t,selectors:[["app-users"]],decls:3,vars:3,consts:[[4,"ngIf"],["class","app-loading",4,"ngIf"],[3,"userSubmitted"],["mat-table","",1,"mat-elevation-z8",3,"dataSource"],["matColumnDef","id"],["mat-header-cell","","appTitle","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","fullName"],["matColumnDef","email"],["matColumnDef","role"],["matColumnDef","fecha"],["matColumnDef","delete",1,"col-6"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell","","appTitle",""],["mat-cell",""],["mat-header-cell",""],["mat-icon-button","",1,"col-offset-6",3,"click"],["color","accent","mat-icon-button","",3,"routerLink"],["mat-header-row",""],["mat-row",""],["type","text","matInput","",3,"ngModel","ngModelChange"],["name","role",3,"ngModel","ngModelChange"],["value","Admin"],["value","user"],["mat-raised-button","","color","accent",3,"click"],[1,"app-loading"],["color","accent",1,"example-margin"]],template:function(n,l){n&1&&h(0,nt,24,3,"div",0)(1,ot,27,4,"div",0)(2,at,2,0,"div",1),n&2&&(d("ngIf",!l.isLoading),s(),d("ngIf",l.editar&&!l.isLoading),s(),d("ngIf",l.isLoading))},dependencies:[W,Ce,xe,Ee,ve,Se,be,ge,Me,Ue,we,k,R,L,A,T,D,oe,y,F,me,de,ee,j,Ve,X,H],styles:[".col-md-2[_ngcontent-%COMP%]{width:20%}"]});let e=t;return e})();var ke=(e,t)=>{let o=U(Z),m=U(ne);return U(te).select(ie).pipe(O(l=>l?.role==="ADMIN"?!0:o.createUrlTree(["dashboard","home"])))};var mt=[{path:"users",canActivate:[ke],component:Re}],Le=(()=>{let t=class t{};t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=I({type:t}),t.\u0275inj=b({imports:[M.forChild(mt),M]});let e=t;return e})();var ei=(()=>{let t=class t{};t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=I({type:t}),t.\u0275inj=b({providers:[H,V],imports:[Y,Ie,Ne,Te,De,ae,he,le,ye,_e,M,Fe,j,Le]});let e=t;return e})();export{ke as a,ei as b};
